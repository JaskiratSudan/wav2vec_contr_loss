Setting up the environment...
Job started on gl1517.arc-ts.umich.edu at Sun Dec 28 02:11:38 EST 2025
Python version: Python 3.9.7
PyTorch version: 2.8.0+cu128
CUDA available: True
Current GPU: NVIDIA A40
----------------------------------------------------------------
EXPERIMENT NAME: supcon_geodesic_temp_0.6
=== CONFIG ===
MODEL_NAME=facebook/wav2vec2-xls-r-300m
SAVE_DIR=/home/jsudan/wav2vec_contr_loss/checkpoints_stage1/supcon_geodesic_temp_0.6/facebook__wav2vec2-xls-r-300m
TRAIN_ROOT=/nfs/turbo/umd-hafiz/issf_server_data/AsvSpoofData_2019/train/LA/ASVspoof2019_LA_train/flac
TRAIN_PROTOCOL=/nfs/turbo/umd-hafiz/issf_server_data/AsvSpoofData_2019/train/LA/ASVspoof2019_train_protocol_with_speaker.txt
DEV_ROOT=/nfs/turbo/umd-hafiz/issf_server_data/AsvSpoofData_2019/train/LA/ASVspoof2019_LA_dev/flac
DEV_PROTOCOL=/nfs/turbo/umd-hafiz/issf_server_data/AsvSpoofData_2019/train/LA/ASVspoof2019_dev_protocol_with_speaker.txt
TARGET_SAMPLE_RATE=16000
MAX_DURATION_SECONDS=5
INPUT_DIM=1024
HIDDEN_DIM=256
DROPOUT=0.1
EPOCHS=100
BATCH_SIZE=32
NUM_SAMPLES=None
HEAD_LR=0.005
ENC_LR=1e-05
WEIGHT_DECAY=0.003
TEMPERATURE=0.6
NUM_WORKERS=4
SEED=1337
UNIFORMITY_WEIGHT=0.0
UNIFORMITY_T=2.0
SUPCON_SIMILARITY=geodesic
TOPK_NEG=15
WARMUP_EPOCHS=100
ALPHA_END=1.0
ALPHA_RAMP_EPOCHS=80
USE_RAWBOOST=True
RAWBOOST_PROB=0.7
FINETUNE_ENCODER=True
DISTRIBUTED=False | WORLD_SIZE=1 | RANK=0
=============
Using device: cuda:0 | RawBoost=True (p=0.7)
CUDA device count: 1
Traceback (most recent call last):
  File "/home/jsudan/wav2vec_contr_loss/train_stage1.py", line 156, in <module>
    main()
  File "/home/jsudan/wav2vec_contr_loss/train_stage1.py", line 122, in main
    train_loss, alpha = train_one_epoch(
  File "/home/jsudan/wav2vec_contr_loss/stage1_utils.py", line 125, in train_one_epoch
    loss = loss_fn(z, labels, topk_neg=cfg.topk_neg, alpha=alpha)
  File "/home/jsudan/myenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/jsudan/myenv/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/jsudan/wav2vec_contr_loss/loss.py", line 114, in forward
    sim = self._pairwise_similarity(z)                             # (B,B)
  File "/home/jsudan/wav2vec_contr_loss/loss.py", line 103, in _pairwise_similarity
    return 1.0 - theta / math.pi     # [0, 1]
NameError: name 'math' is not defined
Using device: cuda
Model: facebook/wav2vec2-xls-r-300m
Checkpoint: /home/jsudan/wav2vec_contr_loss/checkpoints_stage1/supcon_geodesic_temp_0.6/facebook__wav2vec2-xls-r-300m/facebook__wav2vec2-xls-r-300m_stage1_head_best.pt
Saving to: /home/jsudan/wav2vec_contr_loss/plots/dep_embeddings/ASV/supcon_geodesic_temp_0.6/facebook__wav2vec2-xls-r-300m
Loaded finetuned encoder weights from checkpoint.
Collecting embeddings on eval set...
slurmstepd: error: *** JOB 38982874 ON gl1517 CANCELLED AT 2025-12-28T02:18:02 ***
