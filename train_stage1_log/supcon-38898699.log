Setting up the environment...
Job started on gl1526.arc-ts.umich.edu at Wed Dec 24 23:57:43 EST 2025
Python version: Python 3.9.7
PyTorch version: 2.8.0+cu128
CUDA available: True
Current GPU: NVIDIA A40
NVIDIA A40
----------------------------------------------------------------
EXPERIMENT NAME: supcon
W1224 23:57:49.381393 2030046 torch/distributed/run.py:774] 
W1224 23:57:49.381393 2030046 torch/distributed/run.py:774] *****************************************
W1224 23:57:49.381393 2030046 torch/distributed/run.py:774] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W1224 23:57:49.381393 2030046 torch/distributed/run.py:774] *****************************************
[W1224 23:57:49.180877674 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:34167 (errno: 97 - Address family not supported by protocol).
[W1224 23:57:49.181811393 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:34167 (errno: 97 - Address family not supported by protocol).
[W1224 23:57:49.182721095 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [localhost]:34167 (errno: 97 - Address family not supported by protocol).
[W1224 23:57:49.229008944 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [gl1526.arc-ts.umich.edu]:43993 (errno: 97 - Address family not supported by protocol).
[W1224 23:57:55.064782324 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [gl1526.arc-ts.umich.edu]:43993 (errno: 97 - Address family not supported by protocol).
[W1224 23:57:55.065085738 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [gl1526.arc-ts.umich.edu]:43993 (errno: 97 - Address family not supported by protocol).
=== CONFIG ===
MODEL_NAME=facebook/wav2vec2-xls-r-300m
SAVE_DIR=/home/jsudan/wav2vec_contr_loss/checkpoints_stage1/supcon/facebook__wav2vec2-xls-r-300m
TRAIN_ROOT=/nfs/turbo/umd-hafiz/issf_server_data/AsvSpoofData_2019/train/LA/ASVspoof2019_LA_train/flac
TRAIN_PROTOCOL=/nfs/turbo/umd-hafiz/issf_server_data/AsvSpoofData_2019/train/LA/ASVspoof2019_train_protocol_with_speaker.txt
DEV_ROOT=/nfs/turbo/umd-hafiz/issf_server_data/AsvSpoofData_2019/train/LA/ASVspoof2019_LA_dev/flac
DEV_PROTOCOL=/nfs/turbo/umd-hafiz/issf_server_data/AsvSpoofData_2019/train/LA/ASVspoof2019_dev_protocol_with_speaker.txt
TARGET_SAMPLE_RATE=16000
MAX_DURATION_SECONDS=5
INPUT_DIM=1024
HIDDEN_DIM=256
DROPOUT=0.1
EPOCHS=100
BATCH_SIZE=32
NUM_SAMPLES=None
HEAD_LR=0.005
ENC_LR=1e-05
WEIGHT_DECAY=0.003
TEMPERATURE=0.2
NUM_WORKERS=4
SEED=1337
UNIFORMITY_WEIGHT=0.0
UNIFORMITY_T=2.0
SUPCON_SIMILARITY=cosine
TOPK_NEG=15
WARMUP_EPOCHS=100
ALPHA_END=1.0
ALPHA_RAMP_EPOCHS=80
USE_RAWBOOST=True
RAWBOOST_PROB=0.7
FINETUNE_ENCODER=True
DISTRIBUTED=True | WORLD_SIZE=2 | RANK=0
=============
Using device: cuda:0 | RawBoost=True (p=0.7)
CUDA device count: 2
[rank1]:[W1224 23:58:01.316540661 reducer.cpp:1457] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[rank0]:[W1224 23:58:01.741962265 reducer.cpp:1457] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
slurmstepd: error: *** JOB 38898699 ON gl1526 CANCELLED AT 2025-12-24T23:58:02 ***
W1224 23:58:02.983534 2030046 torch/distributed/elastic/agent/server/api.py:723] Received Signals.SIGTERM death signal, shutting down workers
W1224 23:58:02.991003 2030046 torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2030065 closing signal SIGTERM
W1224 23:58:02.991225 2030046 torch/distributed/elastic/multiprocessing/api.py:900] Sending process 2030066 closing signal SIGTERM
